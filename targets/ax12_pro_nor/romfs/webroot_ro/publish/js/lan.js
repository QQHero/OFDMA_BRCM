(window.webpackJsonp=window.webpackJsonp||[]).push([["lan"],{e2ea:function(t,a,e){"use strict";e.r(a);e("4e3f");var s=e("d2db"),n=e("05af"),i=e("f171"),o=e("710d"),r=e("7736");const{mapState:l,mapActions:c}=Object(r.a)("lan");var d={mixins:[s.a],inject:["showConfirm"],props:{wanInfo:{type:Object,default:()=>({})},lanInfo:{type:Object,default:()=>({})},poolInfo:{type:Object,default:()=>({})},isRouter:{type:Boolean,default:!0},workMode:{type:String}},data(){return{dhcpLeaseTimeOption:Object(o.e)(i.a),rules:{lanIP:[Object(o.e)(n.b),this.checkIP,this.checkLanIP],lanMask:Object(o.e)(n.e),lanDns1:[Object(o.e)(n.b),this.checkDns,this.checkDnsNumber.bind(this,1)],lanDns2:[Object(o.e)(n.b),this.checkDns,this.checkDnsNumber.bind(this,2)],dhcpRange:this.checkDhcpRange},dhcpPrefix:"",startIP:"",endIP:"",dhcpRangeStart:1,dhcpRangeEnd:254,tips:_("It specifies the time period during which the assigned IP address remains effective. You are recommended to keep the default settings."),currentLanIP:""}},watch:{"formData.startIP":{handler(t){t&&(this.startIP=t.split(".")[3])},deep:!0,immediate:!0},"formData.endIP":{handler(t){t&&(this.endIP=t.split(".")[3])},deep:!0,immediate:!0},"formData.lanIP":{handler(t){this.$nextTick(()=>{this.$refs.lanIP&&this.$refs.lanIP.checkValid(t)&&(this.currentLanIP=t)})},deep:!0,immediate:!0},"formData.lanMask":{handler(){this.$nextTick(()=>{this.$refs.lanIP&&this.$refs.lanIP.checkValid()&&(this.currentLanIP=this.formData.lanIP)})},deep:!0,immediate:!0}},computed:{...l({vpnClientIp:t=>t.vpnClientIp,pptpSvrIp:t=>t.pptpSvrIP,pptpSvrMask:t=>t.pptpSvrMask,iptvWanIp:t=>t.iptvWanIp,iptvWanMask:t=>t.iptvWanMask,serverIp:t=>t.serverIp,vlan2Ip:t=>t.vlan2Ip,vlan2Mask:t=>t.vlan2Mask,wanIp:t=>t.wanIp,wanMask:t=>t.wanMask}),ipPrefix(){return this.currentLanIP&&this.currentLanIP.split(".").slice(0,3).join(".")+"."}},created(){this.getAllIpData()},methods:{...c(["getAllIpData"]),checkIP(){if(this.$refs.lanMask.checkValid())return Object(o.d)(this.formData.lanIP,this.formData.lanMask)},checkLanIP(){let t=this.formData,a=_("LAN IP Address"),e="";if(this.$refs.lanMask.checkValid()){let s=[[this.wanIp,this.wanMask,a,_("WAN IP Address")],[this.iptvWanIp,this.iptvWanMask,a,_("IPTV IP address")],[this.vlan2Ip,this.vlan2Mask,a,_("Dual Access IP")],[this.vpnClientIp,t.lanMask,a,_("VPN Client IP Address")],[this.serverIp,t.lanMask,a,_("Dual Access Server IP")],[this.wanInfo.wanGateway,this.wanInfo.wanMask,a,_("WAN IP Address")]];return"ap"!=this.workMode&&"apclient"!=this.workMode&&s.push([this.pptpSvrIp,this.pptpSvrMask,a,_("PPTP Server IP Adderss")]),s.forEach(a=>{!e&&a[0]&&(e=Object(o.s)(t.lanIP,t.lanMask,...a))}),e}},checkDnsNumber(t){const a=1===t?this.formData.lanDns1:this.formData.lanDns2;if(this.formData.lanMask&&!["255.255.255.255","255.255.255.254"].includes(this.formData.wanMask))return a?Object(o.d)(a,this.formData.lanMask):""},checkDns(){return this.formData.lanDns1==this.formData.lanDns2&&_("The primary DNS and the secondary DNS cannot be the same")},checkDhcpRange(){let t=~~this.startIP,a=~~this.endIP;return t>=a?_("The end IP address must be greater than the start IP address"):(this.$refs.lanMask.checkValid()&&this.$refs.lanIP.checkValid()?this.getDhcpRange():(this.dhcpRangeStart=1,this.dhcpRangeEnd=254),t<this.dhcpRangeStart||a>this.dhcpRangeEnd?_("Range: %s - %s",[this.dhcpRangeStart,this.dhcpRangeEnd]):void 0)},changeDhcpRange(){this.$nextTick(()=>{this.$refs.lanIP.checkValid()&&this.$refs.lanMask.checkValid()&&(this.getDhcpRange(),this.startIP=this.dhcpRangeStart,this.endIP=this.dhcpRangeEnd,this.$refs.dhcpRange&&this.$refs.dhcpRange.checkValid())})},getDhcpRange(){let t=parseInt(this.formData.lanIP.split(".")[3])||0,a=parseInt(this.formData.lanMask.split(".")[3])||0,e=1;this.dhcpRangeStart=1+(t&a);for(let t=0;t<8;t++)a%2==0&&(e*=2),a/=2;this.dhcpRangeEnd=this.dhcpRangeStart+e-3},async beforeSubmit(t){return(t.dhcpEn||null==t.dhcpEn)&&(t.dhcpEn=null==t.dhcpEn||t.dhcpEn,t.endIP=this.ipPrefix+this.endIP,t.startIP=this.ipPrefix+this.startIP),t.dhcpEn||(t.endIP=this.poolInfo.endIP,t.startIP=this.poolInfo.startIP),t.lanIP!=this.lanInfo.lanIp?this.showConfirm(_("This IP address is also login IP address of the device. Continue?")).then(()=>t).catch(()=>!1):t}}},p=e("0b56"),h=Object(p.a)(d,(function render(){var t=this,a=t._self._c;return a("div",[a("v-form",{ref:t.name,attrs:{rules:t.rules}},[a("v-form-item",{ref:"lanIP",attrs:{label:t._("LAN IP Address"),prop:"lanIP"}},[a("v-input",{attrs:{maxlength:15,placeholder:t._("Login IP address of the router"),disabled:!t.isRouter&&t.formData.isApDhcp},on:{change:t.changeDhcpRange},model:{value:t.formData.lanIP,callback:function(a){t.$set(t.formData,"lanIP",a)},expression:"formData.lanIP"}})],1),a("v-form-item",{ref:"lanMask",attrs:{label:t._("Subnet Mask"),prop:"lanMask"}},[a("v-input",{attrs:{maxlength:15,placeholder:t._("Subnet mask on the LAN side of the router"),disabled:!t.isRouter&&t.formData.isApDhcp},on:{change:t.changeDhcpRange},model:{value:t.formData.lanMask,callback:function(a){t.$set(t.formData,"lanMask",a)},expression:"formData.lanMask"}})],1),t.isRouter?a("div",[a("v-form-item",{attrs:{label:t._("DHCP Server"),prop:"dhcpEn"}},[a("v-switch",{model:{value:t.formData.dhcpEn,callback:function(a){t.$set(t.formData,"dhcpEn",a)},expression:"formData.dhcpEn"}}),a("div",{staticClass:"help-text"},[t._v(" "+t._s(t._("Once enabled, the DHCP server automatically assigns internet parameters such as IP address, subnet mask, and gateway address to the terminal device. You are recommended to enable this function."))+" ")])],1),a("collapse-transition",[t.formData.dhcpEn?a("div",[a("v-form-item",{ref:"dhcpRange",attrs:{label:t._("Address Pool Range"),prop:"dhcpRange"}},[a("div",{staticClass:"inline-block ver-align-top"},[t._v(t._s(t.ipPrefix))]),a("v-input",{staticClass:"ver-align-top",attrs:{maxlength:3,width:"48px",allow:/[0-9]/g},model:{value:t.startIP,callback:function(a){t.startIP=a},expression:"startIP"}}),t._v(" - "),a("v-input",{staticClass:"ver-align-top",attrs:{maxlength:3,width:"48px",allow:/[0-9]/g},model:{value:t.endIP,callback:function(a){t.endIP=a},expression:"endIP"}})],1),a("v-form-item",{attrs:{prop:"dhcpLeaseTime"},scopedSlots:t._u([{key:"label",fn:function(){return[t._v(" "+t._s(t._("Lease Time"))+" "),a("v-tooltip",{attrs:{maxWidth:224,content:t.tips}},[t.formData.dhcpEn?a("span",{staticClass:"tip-icon icon-tip pointer"}):t._e()])]},proxy:!0}],null,!1,627673586)},[a("v-select",{attrs:{options:t.dhcpLeaseTimeOption},model:{value:t.formData.dhcpLeaseTime,callback:function(a){t.$set(t.formData,"dhcpLeaseTime",a)},expression:"formData.dhcpLeaseTime"}})],1)],1):t._e()]),a("v-form-item",{attrs:{label:"DNS",prop:"lanDnsEn"}},[a("v-switch",{model:{value:t.formData.lanDnsEn,callback:function(a){t.$set(t.formData,"lanDnsEn",a)},expression:"formData.lanDnsEn"}})],1),a("collapse-transition",[t.formData.lanDnsEn?a("div",[a("v-form-item",{attrs:{label:t._("Primary DNS"),"relative-prop":"lanDns2",prop:"lanDns1"}},[a("v-input",{attrs:{maxlength:15},model:{value:t.formData.lanDns1,callback:function(a){t.$set(t.formData,"lanDns1",a)},expression:"formData.lanDns1"}})],1),a("v-form-item",{attrs:{label:t._("Secondary DNS"),"relative-prop":"lanDns1",prop:"lanDns2",required:!1}},[a("v-input",{attrs:{maxlength:15,placeholder:t._("Optional")},model:{value:t.formData.lanDns2,callback:function(a){t.$set(t.formData,"lanDns2",a)},expression:"formData.lanDns2"}})],1)],1):t._e()])],1):t._e()],1)],1)}),[],!1,null,null,null).exports,m=e("7886"),f=e("c907"),u=e("f07d"),I={mixins:[f.a,u.a],props:{lanInfo:{type:Object,default:()=>({})}},data(){return{rules:{hostname:Object(o.e)(m.d),mac:[Object(o.e)(n.d),this.checkMac],ip:[Object(o.e)(n.b),this.checkIp]}}},computed:{isManual(){return"manual"==this.formData.chooseDev}},methods:{checkMac(){if(this.tableData.some(({mac:t})=>t.toUpperCase()==this.formData.mac.toUpperCase()))return _("The MAC address already exists")},checkIp(){if(this.tableData.some(({mac:t,ip:a})=>t!=this.formData.mac&&a==this.formData.ip))return _("This IP address has been used");if(this.formData.ip==this.lanInfo.lanIp)return _("Cannot be the same as the login IP address (%s)",[this.lanInfo.lanIp]);let t=Object(o.d)(this.formData.ip,this.lanInfo.lanMask);return t||(Object(o.b)(this.lanInfo.lanIp,this.lanInfo.lanMask,this.formData.ip,this.lanInfo.lanMask)?void 0:_("Must be on the same network segment as the login IP address (%s)",[this.lanInfo.lanIp]))},changeDev(t){this.formData.hostname=this.macToName[t]||"",this.formData.mac="manual"==t?"":t,this.formData.ip=this.macToIp[t]||"",this.$refs.mac.checkValid(this.formData.mac),this.$refs.ip.checkValid(this.formData.ip)},beforeSubmit:t=>(delete t.chooseDev,t)}},v=Object(p.a)(I,(function render(){var t=this,a=t._self._c;return a("v-dialog",{attrs:{title:t.showModaltitle,width:628},on:{confirm:t.submit},model:{value:t.showModal,callback:function(a){t.showModal=a},expression:"showModal"}},[a("div",[a("v-form",{ref:"form",attrs:{rules:t.rules,dialogCenter:!0}},[t.isAdd?a("v-form-item",{attrs:{label:t._("Select Device"),prop:"chooseDev"}},[a("v-select",{attrs:{options:t.chooseDevOption},on:{change:t.changeDev},model:{value:t.formData.chooseDev,callback:function(a){t.$set(t.formData,"chooseDev",a)},expression:"formData.chooseDev"}})],1):t._e(),a("v-form-item",{directives:[{name:"show",rawName:"v-show",value:t.isManual||!t.isAdd,expression:"isManual || !isAdd"}],attrs:{label:t._("Device Name"),prop:"hostname",disabled:t.isAdd&&!t.isManual}},[a("v-input",{attrs:{maxlength:60},model:{value:t.formData.hostname,callback:function(a){t.$set(t.formData,"hostname",a)},expression:"formData.hostname"}})],1),a("v-form-item",{ref:"mac",attrs:{label:t._("MAC Address"),prop:"mac"}},[a("v-input",{attrs:{maxlength:17,placeholder:t._("Format: XX:XX:XX:XX:XX:XX"),disabled:!t.isAdd||!t.isManual},model:{value:t.formData.mac,callback:function(a){t.$set(t.formData,"mac",a)},expression:"formData.mac"}})],1),a("v-form-item",{ref:"ip",attrs:{label:t._("IP Address"),prop:"ip"}},[a("v-input",{attrs:{maxlength:15},model:{value:t.formData.ip,callback:function(a){t.$set(t.formData,"ip",a)},expression:"formData.ip"}})],1)],1)],1)])}),[],!1,null,null,null).exports,D=e("719d");const b={chooseDev:"manual",hostname:"",ip:"",mac:""};var g={mixins:[D.a],components:{staticIpDialog:v},props:{tableData:{type:Array,default:()=>[]},deviceList:{type:Array,default:()=>[]},lanInfo:{type:Object,default:()=>({})}},data:()=>({tableKey:"mac",maxNum:32,formData:Object(o.e)(b),formDefault:Object(o.e)(b),tableItem:[{key:"hostname",label:_("Device Name"),isTooltip:!0},{key:"ip",label:_("IP Address")},{key:"mac",label:_("MAC Address")}]})},k=Object(p.a)(g,(function render(){var t=this,a=t._self._c;return a("div",{staticClass:"v-page-table"},[a("div",{staticClass:"v-page-table__title"},[t._v(t._s(t._("Static IP Reservation List")))]),a("div",{staticClass:"v-page-table__add-icon icon-add2",on:{click:t.addListEvent}}),a("v-table",{ref:"table",attrs:{data:t.tableData,"row-key":"mac",stripe:""}},[t._l(t.tableItem,(function(t){return a("v-table-col",{key:t.key,attrs:{prop:t.key,label:t.label,isTooltip:!!t.isTooltip,align:"center"}})})),a("v-table-col",{attrs:{prop:"option",label:t._("Operation"),align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t._("Edit"),expression:"_('Edit')"}],staticClass:"icon-edit2 v-page-table__icon",on:{click:function(a){return t.editListEvent(e)}}}),a("v-popconfirm",{ref:"popconfirm",attrs:{icon:"v-icon-remind-plane popconfirm-custom-icon",title:t._("Do you want to delete the rule?"),clickOutsideToHide:!0},on:{confirm:function(a){return t.submitDel(e)}}},[a("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t._("Delete"),expression:"_('Delete')"}],staticClass:"icon-delete v-page-table__icon",attrs:{slot:"reference"},slot:"reference"})])]}}])})],2),a("static-ip-dialog",{ref:"dialog",attrs:{option:t.option,formData:t.formData,lanInfo:t.lanInfo,tableData:t.tableData},on:{submitAdd:t.submitAdd,submitEdit:t.submitEdit}})],1)}),[],!1,null,null,null).exports,P=e("e117");const{mapActions:w}=Object(r.a)("devList");var M={components:{lanSettings:h,staticIpList:k,ProgressBar:P.a},data:()=>({pageTitle:_("LAN Settings"),pageTips:_("Here, you can modify the Router LAN IP address, subnet mask and DHCP server parameters, and add static IP address rules."),pageAPTips:_("Here, you can modify the Router LAN IP address and subnet mask."),isloading:!0,lanCfg:{},statusTimer:null,staticIPList:[],deviceList:[],lanInfo:{},wanInfo:{},poolInfo:{},workMode:"",showReboot:!1}),created(){this.init()},computed:{needReboot(){return this.lanCfg.lanIP&&this.lanCfg.lanIP!==this.lanInfo.lanIp},isRouter(){return"router"==this.workMode}},methods:{...w(["setDevData"]),init(t){t&&0==+t.errCode&&this.needReboot?this.showReboot=!0:this.updateData()},submit(){this.$postModule({staticIPList:this.staticIPList},_("Saved successfully. The configurations will take effect when the client connects to the WiFi network the next time")).then(t=>{0==t.errCode&&this.updateTableData()})},updateData(){this.$getData({modules:"lanCfg,staticIPList,deviceList,wanStatus,workMode"}).then(t=>{this.lanCfg=Object(o.e)(t.lanCfg),this.staticIPList=Object(o.e)(t.staticIPList),this.deviceList=Object(o.e)(t.deviceList),this.setDevData(t.deviceList),this.workMode=t.workMode.workMode,this.lanInfo={lanIp:t.lanCfg.lanIP,lanMask:t.lanCfg.lanMask},this.poolInfo={startIP:t.lanCfg.startIP,endIP:t.lanCfg.endIP},this.wanInfo=Object(o.e)(t.wanStatus),this.isloading=!1})},updateTableData(){this.$getData({modules:"staticIPList,deviceList"}).then(t=>{this.staticIPList=Object(o.e)(t.staticIPList),this.deviceList=Object(o.e)(t.deviceList)})}}},x=Object(p.a)(M,(function render(){var t=this,a=t._self._c;return a("div",{staticClass:"lan-set"},[a("v-page-title",{attrs:{title:t.pageTitle,tips:t.isRouter?t.pageTips:t.pageAPTips}}),a("v-loading",{attrs:{visible:t.isloading}}),t.isloading?t._e():a("div",[a("v-page",{attrs:{showFooter:t.isRouter||!t.lanCfg.isApDhcp},on:{init:t.init}},[a("lan-settings",{attrs:{name:"lanCfg",formData:t.lanCfg,wanInfo:t.wanInfo,lanInfo:t.lanInfo,poolInfo:t.poolInfo,isRouter:t.isRouter,workMode:t.workMode}})],1),t.isRouter?a("static-ip-list",{attrs:{tableData:t.staticIPList,deviceList:t.deviceList,lanInfo:t.lanInfo},on:{updateData:t.updateData,submit:t.submit}}):t._e(),t.showReboot?a("progress-bar",{attrs:{time:500,title:t._("Saving… You will be directed to the page of the new IP address once modification completes"),ip:t.lanCfg.lanIP}}):t._e()],1)],1)}),[],!1,null,null,null);a.default=x.exports}}]);